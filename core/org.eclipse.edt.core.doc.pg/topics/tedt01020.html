<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
<meta name="DC.Type" content="topic"></meta>
<meta name="DC.Title" content="Creating an Interface part to access a REST service"></meta>
<meta name="abstract" content="You define an EGL Interface part in a file that is made available to the requester of that service. The Interface part can be in the same EGL package or can be imported from a separate package."></meta>
<meta name="description" content="You define an EGL Interface part in a file that is made available to the requester of that service. The Interface part can be in the same EGL package or can be imported from a separate package."></meta>
<meta name="DC.subject" content="Interface parts, REST service access, creating interfaces"></meta>
<meta name="keywords" content="Interface parts, REST service access, creating interfaces"></meta>
<meta name="DC.Relation" scheme="URI" content="../topics/tedt01002.html"></meta>
<meta name="copyright" content="(C) Copyright 2011" type="primary"></meta>
<meta name="DC.Rights.Owner" content="(C) Copyright 2011" type="primary"></meta>
<meta name="DC.Format" content="XHTML"></meta>
<meta name="DC.Identifier" content="tedt01020"></meta>
<meta name="DC.Language" content="en-us"></meta>
<link rel="stylesheet" type="text/css" href="../../PRODUCT_PLUGIN/style/commonltr.css"></link>
<title>Creating an Interface part to access a REST service</title>
</head>
<body id="tedt01020"><a name="tedt01020"><!-- --></a>


<h1 class="topictitle1">Creating an Interface part to access a REST service</h1>



<div><p>You define an EGL Interface part in a file that is made
available to the requester of that service. The Interface part can
be in the same EGL package or can be imported from a separate package.</p>

<p>An EGL
Interface part includes one or more <dfn class="term">function prototypes</dfn>,
which are descriptions of how to write code to access a given service
operation. A function prototype includes the operation name, parameters
(if any), and a return type (if any). The prototype does not include
the logic of the operation, which is available in the service only.</p>

<p>The Interface part of an EGL REST-RPC service is simpler than an
Interface part for a third-party REST service.</p>

<div class="section"><h2 class="sectiontitle">Interface part for accessing an EGL REST-RPC service</h2><div class="p">This
example shows an Interface part for accessing an EGL REST-RPC service.
The example includes a single function prototype:<pre class="codeblock">Interface EmployeeService
   Function GetEmployeeDetail(employeeCode STRING IN, 
                              employeeSalary FLOAT OUT, 
                              employeeStatus STRING INOUT) 
            returns(myEmployeeRecordPart);
end
</pre>
</div>
<p>You can specify various EGL data types and can
use the modifiers IN, OUT, and INOUT.</p>
<div class="p">To create the Interface
part in the EDT IDE: <ol>
<li>In the Project Explorer view, right-click the EGL file that defines
the service</li>

<li>Click <span class="menucascade"><span class="uicontrol">EGL Services</span> &gt; <span class="uicontrol">Extract
EGL Interface</span></span>.</li>

<li>In the New EGL Interface part window, specify the appropriate
details, and click <span class="uicontrol">Finish</span>.</li>

</ol>
</div>
</div>

<div class="section"><h2 class="sectiontitle">Interface part for accessing a third-party REST service</h2><div class="p">This
example shows Interface part for accessing a third-party REST service:<pre class="codeblock">Interface WeatherForecast
   Function GetWeatherByZipCode(zipcode string in) returns(myRecordPart)
      {@GetRest{uriTemplate="/GetWeatherByZipCode?zipCode={zipcode}",
                requestFormat = JSON,
                responseFormat = JSON}};
end</pre>
</div>
<div class="p">If the purpose of the Interface part is to describe
the operations that are available in a third-party REST service (not
an EGL REST-RPC service), you must specify an annotation for each
function prototype. The name of the annotation indicates the HTTP
verb that is used to access the service: <ul>
<li>For the GET method, the name is <span class="synph"><span class="kwd">GetREST</span></span>.</li>

<li>For the POST method, the name is <span class="synph"><span class="kwd">PostREST</span></span>.</li>

<li>For the PUT method, the name is <span class="synph"><span class="kwd">PutREST</span></span>.</li>

<li>For the DELETE method, the name is <span class="synph"><span class="kwd">DeleteREST</span>.</span></li>

</ul>
</div>
<p>Those annotations are called the xREST annotations because
the same three fields are in each, as described in the xREST annotations
section of this topic.</p>
<div class="p">In the service-invocation statement that
is used to access a third-party REST service, the argument that is
passed to a given function parameter has one of two purposes: <ul>
<li>Usually, the argument provides a value that the requester includes
in the URI. This usage is shown later in this topic, in the description
of the xREST annotations. Those values are not passed to the service
logic; they are values that are embedded in the URI. In particular,
if the annotation is <span class="synph"><span class="kwd">GetREST</span></span>, all of the
arguments that are assigned to the function parameters are used to
construct the URI.</li>

<li>In the case of one argument (at most), the argument is a representation
that is processed by the service; for example, a record that contains
values used to create a database-table row. Here are details:<ul>
<li>If the annotation is <span class="synph"><span class="kwd">PostREST</span></span> or <span class="synph"><span class="kwd">PutREST</span></span> for
a given operation, the additional argument must be present, and the
related parameter is called the <dfn class="term">representation parameter</dfn>. </li>

<li>The argument also might be required if the annotation is <span class="synph"><span class="kwd">DeleteREST</span></span>.
The need for such an argument depends on the service provider. </li>

</ul>
</li>

</ul>
</div>
<div class="p">If the function prototype has a parameter that is not
identified in the <span class="synph"><span class="kwd">uriTemplate</span></span> annotation
field (for <span class="synph"><span class="kwd">PostREST</span></span>, <span class="synph"><span class="kwd">PutREST</span></span>,
or <span class="synph"><span class="kwd">DeleteREST</span></span>), that parameter is a representation
parameter. Either of the following cases is an error:<ul>
<li>Specifying more than one representation parameter</li>

<li>Specifying a representation parameter when <span class="synph"><span class="kwd">GetREST</span></span> is
in use</li>

</ul>
</div>
<p>For restrictions on the arguments sent to a service, see
“Restrictions in the prototypes used for service access.”</p>
<p>You
do not need to create an Interface part. Instead, you can use IRest,
which is an Interface part that is provided for you and that can be
the basis of a variable that is used to access a third-party REST
service. For more information about that Interface part, see “Using
a provided Interface for a third-party REST service.”</p>
</div>

<div class="section"><h2 class="sectiontitle">xREST annotations used for third-party REST services</h2><p>Each
of the xREST annotations has these fields: <span class="synph"><span class="kwd">uriTemplate</span></span>, <span class="synph"><span class="kwd">requestFormat</span></span>,
and <span class="synph"><span class="kwd">responseFormat</span></span>.</p>
<div class="p"><dl>
<dt class="dlterm"><span class="synph"><span class="kwd">uriTemplate</span></span></dt>

<dd>A string, or <dfn class="term">template</dfn>, that in most cases outlines
a relative URI, which identifies the last qualifiers in the URI that
are used to access the service.<div class="p">The first URI qualifiers are specified
in one of the following ways:<ul>
<li>When you declare a variable based on the Interface part, you can
identify an entry in a deployment descriptor. In this case, an initial
value for the URI is in the deployment descriptor, and at configuration
time, a code installer can change that value.</li>

<li>You can update the URI at run time, as described in "Binding an
access variable dynamically.”</li>

</ul>
</div>
<p>If you do not set the URI, the value of the <span class="synph"><span class="kwd">uriTemplate</span></span> annotation
field includes the complete URI. In most cases, the value of the <span class="synph"><span class="kwd">uriTemplate</span></span> field
has two aspects:</p>
<ul>
<li>The value of the <span class="synph"><span class="kwd">uriTemplate</span></span> field can
include a constant value. Those characters are present in or after
every URI that is used to access the function. In the previous example,
the value of <span class="synph"><span class="kwd">uriTemplate</span></span> includes a query
variable, and the constant value is as follows:<pre class="codeblock">   /GetWeatherByZip?zipcode= </pre>
<div class="p">If
the example is changed to include a path variable instead of the query
string, the constant value is as follows:<pre class="codeblock">   /GetWeatherByZip/</pre>
</div>
</li>

<li>The value of the <span class="synph"><span class="kwd">uriTemplate</span></span> annotation
can include path variables and query variables. The previous example
includes a single query variable:<pre class="codeblock">   {zipcode}</pre>
<div class="p">For
the original example with a query string, here is a relative URI and
value that are used to access the service:<pre class="codeblock">/GetWeatherByZip?zipcode=02135</pre>
</div>
<div class="p">If
the template includes a path variable instead of a query string, here
is a relative URI:<pre class="codeblock">/GetWeatherByZip/02135</pre>
</div>
<p>The
EGL runtime code automatically completes a URI encoding on each substitution
value that is specified in a service invocation statement, with one
exception. </p>
<p>For example, if your service-invocation statement
indicates that the value for a given substitution variable is "Jeff
Smith", the EGL runtime code converts the string to "Jeff%20Smith"
so that the URI is valid. However, if the value of a substitution
value begins with <em>http</em>, the EGL runtime code does no URI encoding
because the service-invocation statement is specifying an argument
that provides a complete URI. If you are responsible for URI encoding,
review the documentation on the <span class="synph"><span class="kwd">httpLib.convertToURLEncoded</span></span> system
function.</p>
</li>

</ul>
<p>The default value of the <span class="synph"><span class="kwd">uriTemplate</span></span> field
is an empty string so that, by default, you can specify the complete
URI by setting the base URI.</p>
</dd>


<dt class="dlterm"><span class="synph"><span class="kwd">requestFormat</span></span></dt>

<dd>A value that indicates the format of the representation that is
sent to the service: <ul>
<li>XML, to indicate that the format is Extensible Markup Language</li>

<li>NONE, to indicate that the representation is a string, or a value
that is compatible with a string, and is sent as is</li>

<li>JSON, to indicate that the format is JavaScript Object Notation</li>

<li>FORM, to indicate that the format is form data, which is a record
composed of argument-value pairs. In the following example of the
content sent to the service, each pair is separated from the next
by an ampersand (&amp;):<pre class="codeblock">division=Consumer&amp;dept=Sales</pre>
<div class="p">For
a given field in the Record part that is the basis of form data, you
can specify the <span class="synph"><span class="kwd">FormName</span></span> annotation. You
can use that annotation to work with an argument name that is an EGL
reserved word or is not valid in EGL. Here is an example use of the <span class="synph"><span class="kwd">FormName</span></span> annotation:<pre class="codeblock">record anyRecord
   continue boolean {FormName="continue-content"};
end</pre>
</div>
<div class="p">The runtime code uses the value of the <span class="synph"><span class="kwd">FormName</span></span> annotation
as the name of the argument transmitted to the service. Here is a
representation that might be sent to the service: <pre class="codeblock">continue-content=yes</pre>
</div>
<p>The
default value of the <span class="synph"><span class="kwd">FormName</span></span> annotation
is the name of the record field. In this example, the default is <samp class="codeph">continue</samp>.</p>
<p>You
cannot override the value of the <span class="synph"><span class="kwd">FormName</span></span> annotation
when you declare a record that is based on the Record part.</p>
</li>

</ul>
<div class="p">If the representation is a record, the following statements
apply:<ul>
<li>The default value of <span class="synph"><span class="kwd">requestFormat</span></span> is <em>XML</em>.</li>

<li><em>JSON</em> is also valid.</li>

<li><em>FORM</em> is valid only if every field in the record is of type
STRING or is of a type that is assignment-compatible with STRING. <em>FORM</em> is
not valid if the record references another record.</li>

</ul>
</div>
</dd>


<dt class="dlterm"><span class="synph"><span class="kwd">responseFormat</span></span></dt>

<dd>A value that indicates the format of the representation that is
returned to the requester: <ul>
<li>XML, to indicate that the returned representation is in XML format</li>

<li>NONE, to indicate that the returned representation is a string</li>

<li>JSON, to indicate that the returned representation is in JSON
format</li>

</ul>
<p>If the return value in the Interface part function prototype
is a string or a value that is compatible with a string, the default
value of <span class="synph"><span class="kwd">responseFormat</span></span> is <em>NONE</em>,
which is the only valid format. If the return value is a record, the
default value of <span class="synph"><span class="kwd">responseFormat</span></span> is <em>XML</em>,
and <em>JSON</em> is also valid.</p>
</dd>

</dl>
</div>
<div class="p">You can specify an <span class="synph"><span class="kwd">xREST</span></span> annotation
without assigning values to the annotation fields: <pre class="codeblock">Interface IEmployeeService
   Function GetEmployeeDetail() returns(myRecordPart)
      {@GetRest{}};
end</pre>
</div>
<div class="p">The lack of annotation fields indicates these
behaviors:<ul>
<li>You must provide the complete REST service URI, such as http://www.mycompany.com/myservice,
without providing detail in the Interface part. For information about
the three choices for specifying the base URI, see the description
of <span class="synph"><span class="kwd">uriTemplate</span></span> in this topic.</li>

<li>If the representation parameter (or, for the <span class="synph"><span class="kwd">GetREST</span></span> annotation,
the return value) is a string, the EGL runtime code does no conversion.
You must handle the conversion and can use any of the following functions
for that purpose: <ul compact="compact">
<li>JSONLib.convertFromJSON</li>

<li>JSONLib.convertToJSON</li>

<li>XMLLib.convertFromXML</li>

<li>XMLLib.convertToXML</li>

</ul>
</li>

<li>If the representation parameter is a record, the EGL runtime code
converts the related argument to Extensible Markup Language (XML)
format. </li>

<li>For the <span class="synph"><span class="kwd">GetREST</span></span> annotation, if the return
value is a record, the EGL runtime code converts that record from
XML format.</li>

</ul>
.</div>
</div>

</div>

<div>
<div class="familylinks">
</div>
</div>

</body>
</html>